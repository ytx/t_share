# T-SHARE - 定型文管理・共有Webアプリケーション

定型文を管理・共有するためのWebアプリケーション。ユーザーが定型文を作成・編集・共有し、文書作成時に効率的に活用できるシステムです。

## 🚀 クイックスタート

### 開発環境
```bash
# バックエンド
cd backend
npm install
npm run dev

# フロントエンド（別ターミナル）
cd frontend
npm install
npm run dev
```

### ローカルプロダクション環境
```bash
# 簡単起動
./scripts/start-prod.sh

# または手動起動
docker-compose -f docker-compose.prod.yml up --build -d
```

## 📦 環境構成

### 開発環境
- **フロントエンド**: http://localhost:3000 (Vite開発サーバー)
- **バックエンド**: http://localhost:3101 (ts-node + nodemon)
- **データベース**: localhost:5434 (PostgreSQL)

### ローカルプロダクション環境
- **フロントエンド**: http://localhost:3200 (Nginx + 静的ファイル)
- **バックエンド**: http://localhost:4200 (Node.js + ビルド済みJS)
- **データベース**: localhost:5200 (PostgreSQL)

## 📋 主要機能

1. **認証・権限管理** - Googleログイン、管理者権限、ユーザー承認フロー
2. **定型文管理** - 作成・編集・検索・履歴管理、タグ・シーン分類、三状態フィルター
3. **プロジェクト管理** - 作成・編集・削除、公開/非公開設定、所有者変更（管理者）
4. **文書作成・参照** - ACEエディタ、マークダウン、プレビュー、文書検索モーダル
5. **変数管理** - ユーザ変数・プロジェクト変数、チェックボックス機能
6. **設定管理** - エディタ設定（テーマ、キーバインディング）、ダークモード対応
7. **管理機能** - ユーザー・タグ・シーン・プロジェクト・データ管理、データエクスポート/インポート
8. **プロジェクト内共有** - プロジェクトごとの共有文書、自動保存機能
9. **個人メモ** - ユーザーごとの個人メモ、複数デバイス間同期

## 🛠 技術スタック

- **フロントエンド**: React 18 + TypeScript + Vite + Material-UI
- **バックエンド**: Node.js + Express + TypeScript + Prisma
- **データベース**: PostgreSQL 15
- **認証**: Google OAuth 2.0 + JWT
- **デプロイ**: Docker + Nginx

## 📚 詳細ドキュメント

- [ローカルプロダクション環境セットアップ](docs/PRODUCTION_SETUP.md)
- [開発ガイドライン](CLAUDE.md)

## 🔧 開発コマンド

```bash
# ビルド
npm run build

# テスト実行
npm test

# リント・型チェック
npm run lint
npm run typecheck

# プロダクション環境停止
./scripts/stop-prod.sh
```

## 📝 最新の更新 (2025-10-01)

### 主要な追加機能
- ✅ **プロジェクト内共有文書機能** - プロジェクトメンバー全員が編集可能な共有文書
- ✅ **個人メモ機能のサーバーストレージ化** - LocalStorageからサーバー保存に移行、複数デバイス同期対応
- ✅ **タブ切り替え時の自動保存** - flush機能による未保存データの確実な保存
- ✅ **データエクスポートのJST対応** - ファイル名タイムスタンプのタイムゾーン修正
- ✅ **リフレッシュボタン追加** - プロジェクト・シーン・定型文・文書の最新データ取得
- ✅ **プロジェクト所有者変更機能**（管理者専用）
- ✅ **文書検索モーダルの改善**（日本語IME対応、検索ボタン追加）
- ✅ **プロジェクト文書の全文表示**（公開プロジェクトの文書は全員閲覧可）
- ✅ **ダークモード対応の強化**（文書表示エリアの配色改善）

### 技術的改善
- **TypeScriptコンパイルエラー完全解決** - バックエンド: 22→0エラー、フロントエンド: 0エラー維持
- **自動保存機能の安定化** - 3秒デバウンス、インジケーター表示修正
- **RTKクエリキャッシュ管理の最適化** - 特殊文書のキャッシュ無効化処理
- **CSS表示制御によるコンポーネント状態維持** - タブ切り替え時の内容保持
- **特殊文書のアクセス制御実装** - タイトルベースの権限チェック

### 新規APIエンドポイント
- `GET /api/documents/project/:projectId/shared` - プロジェクト内共有文書取得・作成
- `GET /api/documents/personal-memo` - 個人メモ取得・作成

詳細は [CLAUDE.md](CLAUDE.md) を参照してください。

## 📄 ライセンス

MIT License
